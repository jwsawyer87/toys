#! /usr/bin/python -u

import os
import sys
import getopt
import subprocess

def syntax(msg=None):
  if msg:
    sys.stderr.write('{msg}\n'.format(**locals()))
  sys.stderr.write('{pgm} [--verbose] dir1 dir2 file ...\n'.format(pgm=sys.argv[0]))
  exit(1)

def getdir(args):
  if not args:
    syntax('Missing directory or directories')

  path = args.pop(0)
  if not os.path.isdir(path):
    syntax('{path!r} is not a directory'.format(**locals()))

  return (path, args)

def diff(dir1, dir2):
  files1 = os.list(dir1)
  files2 = os.list(dir2)
  while files1 or file2:
    file1 = files1[0] if files1 else None
    file2 = files2[0] if files2 else None

verbose = False
(opts, args) = ([], [])
try:
  (opts, args) = getopt.getopt(sys.argv[1:], 'v', ['verbose'])
except Exception as e:
  syntax(str(e))

for (opt, arg) in opts:
  if opt in ['-v', '--verbose']:
    verbose = not verbose

(dir1, args) = getdir(args)
(dir2, args) = getdir(args)

if not args:
  syntax('A list of files is required')

diff(dir1, dir2)
